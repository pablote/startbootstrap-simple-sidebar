<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Startbootstrap-simple-sidebar by ironsummitmedia</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Startbootstrap-simple-sidebar</h1>
        <p class="header"></p>

       

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/ironsummitmedia">ironsummitmedia</a></p>


      </header>
      <section>
        <em><strong>1.9.3 and 2.0 Only - NT Only - I was unable to upgrade successfully to version 2.0. </strong><strong>How can I restore to the prior version of Post.Office using my standard, full system </strong><strong>backup files?</strong></em>

If you made a total backup of your Post.Office system before upgrading (as instructed in the upgrade procedure) you should have copies of the following items:

<strong>Registry information</strong>
<ul>
 	<li>HKEY_LOCAL_MACHINE\SOFTWARE\Software.com\Post.Office
(suggested name &amp; location: <em>anotherhost</em>\temp\Post.OfficeRegKey<em>version#</em>)</li>
 	<li>HKEY_LOCAL_MACHINE\SOFTWARE\Software.com\Post.Office\MTA-Accounts
(suggested name &amp; location: <em>anotherhost</em>\temp\MTA-AccountsRegKey<em>version#</em>)</li>
</ul>
<strong>File system information</strong>
<ul>
 	<li>The Post.Office Directory containing configuration information
(suggested name &amp; location: <em>anotherhost</em>\temp\Post.Office<em>version#</em>config)</li>
 	<li>The Program Directory containing Post.Office executables
(suggested name &amp; location: <em>anotherhost</em>\temp\Post.Office<em>version#</em>execs)</li>
 	<li>The Mailbox Directory containing your mailbox information
(suggested name &amp; location: <em>anotherhost</em>\temp\Post.Office<em>version#</em>mailbox)</li>
</ul>
The instructions that follow will guide you through the restoration process. They assume that you named the backup files as suggested. If you selected other names or locations for those files you will need to adjust the instructions accordingly.
<ol>
 	<li>Make sure that you are logged in as the Local Administrator of your host. Logging in as the Domain Administrator is not sufficient unless the machine you are using is a Primary Domain Controller.</li>
 	<li>Shutdown the Post.Office Service from within Program Manager:</li>
</ol>
<ul>
 	<li>Double click on the Control Panel icon.</li>
 	<li>Double click on the Services icon.</li>
 	<li>Locate and select the list entry for the post.office MTA.</li>
 	<li>Click on the Stop button.</li>
</ul>
<ol>
 	<li>Set permissions on the Post.Office Registry key to allow Everyone Full Control:</li>
</ol>
<ul>
 	<li>Launch a DOS shell.</li>
 	<li>Change directory to the location in which the Post.Office executables reside
Note: The poperms script must reside there as well.</li>
 	<li>Type: poperms -r -Everyone -u</li>
</ul>
<ol>
 	<li>Back up the 2.0 version of the Post.Office Registry key:</li>
</ol>
<ul>
 	<li>Launch REGEDT32.exe.</li>
 	<li>Follow the path HKEY_LOCAL_MACHINE/SOFTWARE/software.com
to locate the Post.Office key.</li>
 	<li>Select the Post.Office key.</li>
 	<li>Pull down the Registry menu and choose the Save Key command.
(suggested name to save under: Post.OfficeRegKey2.0)</li>
</ul>
<ol>
 	<li>Restore the prior version of the Post.Office Registry key:</li>
</ol>
<ul>
 	<li>Make sure that the Post.Office key remains selected (highlighted).</li>
 	<li>Pull down the Registry menu and choose the Restore command.</li>
 	<li>Use the browser window to locate and select your backup copy of the prior Post.Office Registry key (suggested name was Post.OfficeRegKey<em>version#</em>)
then click on the OK button.</li>
 	<li>Confirm your desire to overwrite the current key by clicking on the YES button of the alert box that appears.</li>
</ul>
<ol>
 	<li>Set permissions on the Post.Office Registry key back to the default permissions for your Post.Office-User:</li>
</ol>
<ul>
 	<li>Return to the DOS command line (within the Post.Office executables directory) and type:
poperms -r -u</li>
</ul>
<ol>
 	<li>Set file system permissions for your Post.Office Executables, Configuration and Mailbox directories to allow Everyone to have Full Control.

Note: The exact location of the required directories can be found via the Program Manager by double clicking on the Main\Control Panel\Post.Office icons in the order indicated. When the Post.Office applet window appears look at the bottom to determine the locations of the Post.Office Directory containing configuration information, the Program Directory containing Post.Office executables, and the Mailbox Directory containing your mailbox information .</li>
</ol>
<ul>
 	<li>type: poperms -f -Everyone -u</li>
</ul>
<ol>
 	<li>Back up the 2.0 Post.Office executables you have now.</li>
</ol>
<ul>
 	<li>Launch the File Manager.</li>
 	<li>Locate and select the Post.Office directory.
(the default location is \win32app\Post.Office)</li>
 	<li>From the File menu choose the Move command.</li>
 	<li>Type the name and location of the backup directory in the To: field provided,
then click on the OK button.
(suggested name and location is <em>anotherhost</em>\temp\Post.Office2.0exec)</li>
</ul>
<ol>
 	<li>Restore your saved Post.Office executables (the prior version).</li>
</ol>
<ul>
 	<li>Locate and select your backup copy of the prior Post.Office executables.
(suggested name and location was <em>anotherhost</em>\temp\Post.Office<em>version#</em>exec)</li>
 	<li>From the File menu choose the Move command.</li>
 	<li>Type the new name and location in the To: field provided, then click on the OK button. (Default name and location is \win32app\Post.Office)</li>
 	<li>Confirm that you wish to replace the existing directory.</li>
 	<li>You will need to move your poperms script from the backup directory made in Step 8 (suggested name and location was <em>anotherhost</em>\temp\Post.Office2.0exec)
to the restored directory (\win32app\Post.Office, if you used the default name and location).</li>
</ul>
<ol>
 	<li>Back up the current Post.Office 2.0 configuration information.</li>
</ol>
<ul>
 	<li>Locate and select the Post.Office directory.
(the default location is \winnt35\system32\spool\Post.Office)</li>
 	<li>From the File menu choose the Move command.</li>
 	<li>Type the new name and location in the To: field provided, then click on the OK button. (suggested name and location is <em>anotherhost</em>\temp\Post.Office2.0config)</li>
</ul>
<ol>
 	<li>Restore your saved Post.Office configuration information (the prior version).</li>
</ol>
<ul>
 	<li>Locate and select your backup copy of the prior Post.Office executables.
(suggested name and location was <em>anotherhost</em>\temp\Post.Office<em>version#</em>config)</li>
 	<li>From the File menu choose the Move command</li>
 	<li>Type the new name and location in the To: field provided, then click on the OK button. (default name and location is \winnt35\system32\spool\Post.Office)</li>
 	<li>Confirm that you wish to replace the existing directory.</li>
</ul>
<ol>
 	<li>Back up the Post.Office 2.0 mailboxes you have now.</li>
</ol>
<ul>
 	<li>Locate and select the Post.Office mailbox directory.
(the default location is \winnt35\system32\spool\Post.Office\mailbox)</li>
 	<li>From the File menu choose the Move command.</li>
 	<li>Type the new name and location in the To: field provided, then click on the OK button. (suggested name and location is anotherhost\temp\Post.Office2.0mailbox)</li>
</ul>
<ol>
 	<li>Restore your saved Post.Office mailboxes (from before the upgrade).</li>
</ol>
<ul>
 	<li>Locate and select your backup copy of the prior Post.Office mailboxes.
(suggested name and location was <em>anotherhost</em>\temp\Post.Office<em>version#</em>mailbox)</li>
 	<li>From the File menu choose the Move command.</li>
 	<li>Type the new name and location in the To: field provided, then click on the OK button. (default name and location is \winnt35\system32\spool\Post.Office\mailbox)</li>
 	<li>Confirm that you wish to replace the existing directory.</li>
</ul>
<ol>
 	<li>Run the poperms tool to set file system permissions for your Post.Office Executables, Configuration and Mailbox directories back to the secure default settings where your Post.Office-user has Full Control. Return to the DOS command line (within the Post.Office executables directory) and type:

poperms -f -u</li>
 	<li>Startup the Post.Office Service by returning to the Services window, selecting the post.office MTA entry from the list, and clicking on the Start button.</li>
</ol>
&nbsp;</section>
      <footer>
        
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
